title: Potential APT FIN7 Exploitation Activity
id: 288761b1-1985-c83b-bafb-51f20cffc924
related:
    - id: 6676896b-2cce-422d-82af-5a1abe65e241
      type: derived
status: test
description: |
    Detects potential APT FIN7 exploitation activity as reported by Google.
    In order to obtain initial access, FIN7 used compromised Remote Desktop Protocol (RDP) credentials to login to a target server and initiate specific Windows process chains.
references:
    - https://cloud.google.com/blog/topics/threat-intelligence/evolution-of-fin7/
author: Alex Walston (@4ayymm)
date: 2024-07-29
tags:
    - attack.execution
    - attack.t1059.001
    - attack.t1059.003
    - detection.emerging-threats
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 4688
        Channel: Security
    selection_notepad_plus:
        ParentProcessName|endswith: \notepad++.exe
        NewProcessName|endswith: \cmd.exe
    selection_rdpinit:
        ParentProcessName|endswith: \rdpinit.exe
        NewProcessName|endswith: \notepad++.exe
    condition: process_creation and (1 of selection_*)
falsepositives:
    - Notepad++ can legitimately spawn cmd (Open Containing Folder in CMD)
level: medium
ruletype: Sigma
