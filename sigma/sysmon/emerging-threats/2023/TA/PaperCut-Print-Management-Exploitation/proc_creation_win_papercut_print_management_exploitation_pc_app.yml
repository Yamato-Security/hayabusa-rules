title: PaperCut MF/NG Potential Exploitation
id: 5ff9d234-9fb7-75d0-e97a-91230aff97f6
related:
    - id: 0934ac71-a331-4e98-a034-d49c491fbbcb
      type: derived
status: test
description: Detects suspicious child processes of "pc-app.exe". Which could indicate potential exploitation of PaperCut
references:
    - https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software
    - https://github.com/huntresslabs/threat-intel/blob/3bad6b0fadfcca3ff5680923e74e39edd72f32da/2023/2023-04/20-PaperCut/win_susp_papercut_code_execution.yml
author: Nasreddine Bencherchali (Nextron Systems), Huntress DE&TH Team (idea)
date: '2023-04-20'
modified: '2023-04-25'
tags:
    - attack.execution
    - detection.emerging-threats
    - sysmon
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 1
        Channel: Microsoft-Windows-Sysmon/Operational
    selection:
        ParentImage|endswith: \pc-app.exe
        Image|endswith:
            - \bash.exe
            - \calc.exe
            - \certutil.exe
            - \cmd.exe
            - \csc.exe
            - \cscript.exe
            - \dllhost.exe
            - \mshta.exe
            - \msiexec.exe
            - \powershell.exe
            - \pwsh.exe
            - \regsvr32.exe
            - \rundll32.exe
            - \scriptrunner.exe
            - \wmic.exe
            - \wscript.exe
            - \wsl.exe
    condition: process_creation and selection
falsepositives:
    - Legitimate administration activity
level: high
ruletype: Sigma
