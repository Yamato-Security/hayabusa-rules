title: Suspicious Typical Malware Back Connect Ports
ruletype: Sigma
author: Florian Roth (Nextron Systems)
date: 2017/03/19
description: Detects programs that connect to typical malware back connect ports based
    on statistical analysis from two different sandbox system databases
detection:
    SELECTION_1:
        EventID: 3
    SELECTION_10:
        DestinationPort: 700
    SELECTION_11:
        DestinationPort: 743
    SELECTION_12:
        DestinationPort: 777
    SELECTION_13:
        DestinationPort: 1443
    SELECTION_14:
        DestinationPort: 1515
    SELECTION_15:
        DestinationPort: 1777
    SELECTION_16:
        DestinationPort: 1817
    SELECTION_17:
        DestinationPort: 1904
    SELECTION_18:
        DestinationPort: 1960
    SELECTION_19:
        DestinationPort: 2443
    SELECTION_2:
        Channel: Microsoft-Windows-Sysmon/Operational
    SELECTION_20:
        DestinationPort: 2448
    SELECTION_21:
        DestinationPort: 3360
    SELECTION_22:
        DestinationPort: 3675
    SELECTION_23:
        DestinationPort: 3939
    SELECTION_24:
        DestinationPort: 4040
    SELECTION_25:
        DestinationPort: 4433
    SELECTION_26:
        DestinationPort: 4438
    SELECTION_27:
        DestinationPort: 4443
    SELECTION_28:
        DestinationPort: 4444
    SELECTION_29:
        DestinationPort: 4455
    SELECTION_3:
        Initiated: 'true'
    SELECTION_30:
        DestinationPort: 5445
    SELECTION_31:
        DestinationPort: 5552
    SELECTION_32:
        DestinationPort: 5649
    SELECTION_33:
        DestinationPort: 6625
    SELECTION_34:
        DestinationPort: 7210
    SELECTION_35:
        DestinationPort: 8080
    SELECTION_36:
        DestinationPort: 8143
    SELECTION_37:
        DestinationPort: 8843
    SELECTION_38:
        DestinationPort: 8888
    SELECTION_39:
        DestinationPort: 9631
    SELECTION_4:
        DestinationPort: 100
    SELECTION_40:
        DestinationPort: 9943
    SELECTION_41:
        DestinationPort: 10101
    SELECTION_42:
        DestinationPort: 12102
    SELECTION_43:
        DestinationPort: 12103
    SELECTION_44:
        DestinationPort: 12322
    SELECTION_45:
        DestinationPort: 13145
    SELECTION_46:
        DestinationPort: 13394
    SELECTION_47:
        DestinationPort: 13504
    SELECTION_48:
        DestinationPort: 13505
    SELECTION_49:
        DestinationPort: 13506
    SELECTION_5:
        DestinationPort: 198
    SELECTION_50:
        DestinationPort: 13507
    SELECTION_51:
        DestinationPort: 14102
    SELECTION_52:
        DestinationPort: 14103
    SELECTION_53:
        DestinationPort: 14154
    SELECTION_54:
        DestinationPort: 49180
    SELECTION_55:
        DestinationPort: 65520
    SELECTION_56:
        DestinationPort: 65535
    SELECTION_57:
        DestinationIp:
        - 10.*
        - 127.*
        - 172.16.*
        - 172.17.*
        - 172.18.*
        - 172.19.*
        - 172.20.*
        - 172.21.*
        - 172.22.*
        - 172.23.*
        - 172.24.*
        - 172.25.*
        - 172.26.*
        - 172.27.*
        - 172.28.*
        - 172.29.*
        - 172.30.*
        - 172.31.*
        - 192.168.*
    SELECTION_58:
        Image:
        - C:\Program Files\\*
        - C:\Program Files (x86)\\*
    SELECTION_6:
        DestinationPort: 200
    SELECTION_7:
        DestinationPort: 243
    SELECTION_8:
        DestinationPort: 473
    SELECTION_9:
        DestinationPort: 666
    condition: ((SELECTION_1 and SELECTION_2) and ((SELECTION_3 and (SELECTION_4 or
        SELECTION_5 or SELECTION_6 or SELECTION_7 or SELECTION_8 or SELECTION_9 or
        SELECTION_10 or SELECTION_11 or SELECTION_12 or SELECTION_13 or SELECTION_14
        or SELECTION_15 or SELECTION_16 or SELECTION_17 or SELECTION_18 or SELECTION_19
        or SELECTION_20 or SELECTION_21 or SELECTION_22 or SELECTION_23 or SELECTION_24
        or SELECTION_25 or SELECTION_26 or SELECTION_27 or SELECTION_28 or SELECTION_29
        or SELECTION_30 or SELECTION_31 or SELECTION_32 or SELECTION_33 or SELECTION_34
        or SELECTION_35 or SELECTION_36 or SELECTION_37 or SELECTION_38 or SELECTION_39
        or SELECTION_40 or SELECTION_41 or SELECTION_42 or SELECTION_43 or SELECTION_44
        or SELECTION_45 or SELECTION_46 or SELECTION_47 or SELECTION_48 or SELECTION_49
        or SELECTION_50 or SELECTION_51 or SELECTION_52 or SELECTION_53 or SELECTION_54
        or SELECTION_55 or SELECTION_56)) and  not ((SELECTION_57))) and  not ((SELECTION_58)))
falsepositives:
- Unknown
id: 4b89abaa-99fe-4232-afdd-8f9aa4d20382
level: medium
logsource:
    category: network_connection
    product: windows
modified: 2023/05/02
references:
- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo
status: test
tags:
- attack.persistence
- attack.command_and_control
- attack.t1571

