title: PaperCut MF/NG Potential Exploitation
ruletype: Sigma
author: Nasreddine Bencherchali (Nextron Systems), Huntress DE&TH Team (idea)
date: 2023/04/20
description: Detects suspicious child processes of "pc-app.exe". Which could indicate
    potential exploitation of PaperCut
detection:
    SELECTION_1:
        EventID: 4688
    SELECTION_2:
        Channel: Security
    SELECTION_3:
        ParentProcessName: '*\pc-app.exe'
    SELECTION_4:
        NewProcessName:
        - '*\bash.exe'
        - '*\calc.exe'
        - '*\certutil.exe'
        - '*\cmd.exe'
        - '*\csc.exe'
        - '*\cscript.exe'
        - '*\dllhost.exe'
        - '*\mshta.exe'
        - '*\msiexec.exe'
        - '*\powershell.exe'
        - '*\pwsh.exe'
        - '*\regsvr32.exe'
        - '*\rundll32.exe'
        - '*\scriptrunner.exe'
        - '*\wmic.exe'
        - '*\wscript.exe'
        - '*\wsl.exe'
    condition: (SELECTION_1 and SELECTION_2 and SELECTION_3 and SELECTION_4)
falsepositives:
- Legitimate administration activity
id: 0934ac71-a331-4e98-a034-d49c491fbbcb
level: high
logsource:
    category: process_creation
    product: windows
modified: 2023/04/25
references:
- https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software
- https://github.com/huntresslabs/threat-intel/blob/main/2023/2023-04/20-PaperCut/win_susp_papercut_code_execution.yml
status: test
tags:
- attack.execution

