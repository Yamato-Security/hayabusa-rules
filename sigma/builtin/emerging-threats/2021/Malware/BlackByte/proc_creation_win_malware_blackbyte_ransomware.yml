title: Potential BlackByte Ransomware Activity
id: de11bbb4-9429-4ee9-9039-d71a174c512e
related:
    - id: 999e8307-a775-4d5f-addc-4855632335be
      type: derived
status: test
description: Detects command line patterns used by BlackByte ransomware in different operations
references:
    - https://redcanary.com/blog/blackbyte-ransomware/
author: Florian Roth (Nextron Systems)
date: 2022-02-25
modified: 2023-02-08
tags:
    - attack.execution
    - attack.defense-evasion
    - attack.impact
    - attack.t1485
    - attack.t1498
    - attack.t1059.001
    - attack.t1140
    - detection.emerging-threats
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 4688
        Channel: Security
    selection_1:
        CommandLine|contains: ' -single '
        NewProcessName|startswith: C:\Users\Public\
    selection_2:
        CommandLine|contains:
            - del C:\Windows\System32\Taskmgr.exe
            - ;Set-Service -StartupType Disabled $
            - powershell -command "$x =[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(
            - ' do start wordpad.exe /p '
    condition: process_creation and (1 of selection_*)
falsepositives:
    - Unknown
level: high
ruletype: Sigma
