title: Small Sieve Malware File Indicator Creation
id: 39466c42-c189-476a-989f-8cdb135c163a
status: experimental
description: Detects filename indicators that contain a specific typo seen used by the Small Sieve malware.
references:
    - https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/small-sieve/NCSC-MAR-Small-Sieve.pdf
author: Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)
date: 2023/05/19
tags:
    - attack.defense_evasion
    - attack.t1036.005
    - detection.emerging_threats
    - sysmon
logsource:
    product: windows
    category: file_event
detection:
    file_event:
        EventID: 11
        Channel: Microsoft-Windows-Sysmon/Operational
    selection_typo_path:
        TargetFilename|contains|all:
            - :\Users\
            - \AppData\
        TargetFilename|contains:
            - \Roaming\
            - \Local\
    selection_typo_keyword:
        TargetFilename|contains: Microsift
    selection_ioc:
        TargetFilename|endswith: \AppData\Local\MicrosoftWindowsOutlookDataPlus.txt
    condition: file_event and (all of selection_typo_* or selection_ioc)
falsepositives:
    - Unlikely
level: high
ruletype: Sigma
