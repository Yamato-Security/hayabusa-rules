title: PUA - Nimgrab Execution
ruletype: Sigma
author: frack113
date: 2022/08/28
description: Detects the usage of nimgrab, a tool bundled with the Nim programming
    framework and used for downloading files.
detection:
    SELECTION_1:
        EventID: 1
    SELECTION_2:
        Channel: Microsoft-Windows-Sysmon/Operational
    SELECTION_3:
        Image: '*\nimgrab.exe'
    SELECTION_4:
        Hashes:
        - '*MD5=2DD44C3C29D667F5C0EF5F9D7C7FFB8B*'
        - '*SHA256=F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559*'
        - '*IMPHASH=C07FDDD21D123EA9B3A08EEF44AAAC45*'
    SELECTION_5:
        md5: 2DD44C3C29D667F5C0EF5F9D7C7FFB8B
    SELECTION_6:
        sha256: F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559
    SELECTION_7:
        Imphash: C07FDDD21D123EA9B3A08EEF44AAAC45
    condition: ((SELECTION_1 and SELECTION_2) and (SELECTION_3 or SELECTION_4 or SELECTION_5
        or SELECTION_6 or SELECTION_7))
falsepositives:
- Legitimate use of Nim on a developer systems
id: 74a12f18-505c-4114-8d0b-8448dd5485c6
level: high
logsource:
    category: process_creation
    product: windows
modified: 2023/02/13
references:
- https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md
status: experimental
tags:
- attack.command_and_control
- attack.t1105

