title: PaperCut MF/NG Potential Exploitation
ruletype: Sigma
author: Nasreddine Bencherchali (Nextron Systems), Huntress DE&TH Team (idea)
date: 2023/04/20
description: Detects suspicious child processes of "pc-app.exe". Which could indicate
    potential exploitation of PaperCut
detection:
    SELECTION_1:
        EventID: 4688
    SELECTION_2:
        Channel: Security
    SELECTION_3:
        ParentProcessName: '*\pc-app.exe'
    SELECTION_4:
        NewProcessName:
        - '*\cmd.exe'
        - '*\powershell.exe'
        - '*\pwsh.exe'
    condition: (SELECTION_1 and SELECTION_2 and SELECTION_3 and SELECTION_4)
falsepositives:
- Legitimate administration activity
id: de1bd0b6-6d59-417c-86d9-a44114aede3b
level: high
logsource:
    category: process_creation
    product: windows
references:
- https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software
- https://github.com/huntresslabs/threat-intel/blob/main/2023/2023-04/20-PaperCut/win_susp_papercut_code_execution.yml
status: test
tags:
- attack.execution

