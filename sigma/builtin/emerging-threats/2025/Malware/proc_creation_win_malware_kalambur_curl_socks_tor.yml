title: Kalambur Backdoor Curl TOR SOCKS Proxy Execution
id: 073e0fdf-35a4-362b-a1c6-2b1b41c71231
related:
    - id: e99375eb-3ee0-407a-9f90-79569cc6a01c
      type: derived
status: experimental
description: Detects the execution of the "curl.exe" command, referencing "SOCKS" and ".onion" domains, which could be indicative of Kalambur backdoor activity.
references:
    - https://blog.eclecticiq.com/sandworm-apt-targets-ukrainian-users-with-trojanized-microsoft-kms-activation-tools-in-cyber-espionage-campaigns
author: Arda Buyukkaya (EclecticIQ)
date: 2025-02-11
tags:
    - attack.execution
    - attack.command-and-control
    - attack.t1090
    - attack.t1573
    - attack.t1071.001
    - attack.t1059.001
    - attack.s0183
    - detection.emerging-threats
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 4688
        Channel: Security
    selection_img:
        NewProcessName|endswith: \curl.exe
    selection_socks:
        CommandLine|contains:
            - socks5h://
            - socks5://
            - socks4a://
    selection_onion:
        CommandLine|contains: .onion
    condition: process_creation and (all of selection_*)
falsepositives:
    - Unlikely
level: high
ruletype: Sigma
