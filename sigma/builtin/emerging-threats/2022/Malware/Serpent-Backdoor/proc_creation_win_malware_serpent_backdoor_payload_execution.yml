title: Serpent Backdoor Payload Execution Via Scheduled Task
id: aadf7b08-beb0-7b83-9155-bc9cf4ea77be
related:
    - id: d5eb7432-fda4-4bba-a37f-ffa74d9ed639
      type: derived
status: experimental
description: |
    Detects post exploitation execution technique of the Serpent backdoor.
    According to Proofpoint, one of the commands that the backdoor ran was via creating a temporary scheduled task using an unusual method.
    It creates a fictitious windows event and a trigger in which once the event is created, it executes the payload.
references:
    - https://www.proofpoint.com/us/blog/threat-insight/serpent-no-swiping-new-backdoor-targets-french-entities-unique-attack-chain
author: '@kostastsale'
date: 2022-03-21
tags:
    - attack.execution
    - attack.persistence
    - attack.t1053.005
    - attack.t1059.006
    - detection.emerging-threats
    - sysmon
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 4688
        Channel: Security
    selection:
        CommandLine|contains|all:
            - '[System/EventID='
            - /create
            - /delete
            - /ec
            - /so
            - /tn run
        NewProcessName|endswith:
            - \cmd.exe
            - \powershell.exe
    condition: process_creation and selection
falsepositives:
    - Unlikely
level: high
ruletype: Sigma
