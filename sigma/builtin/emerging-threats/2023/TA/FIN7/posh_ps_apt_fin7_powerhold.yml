title: Potential APT FIN7 POWERHOLD Execution
ruletype: Sigma
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/05/04
description: Detects execution of the POWERHOLD script seen used by FIN7 as reported
    by WithSecureLabs
detection:
    SELECTION_1:
        EventID: 4104
    SELECTION_2:
        Channel:
        - Microsoft-Windows-PowerShell/Operational
        - PowerShellCore/Operational
    SELECTION_3:
        ScriptBlockText: '*$env:APPDATA*'
    SELECTION_4:
        ScriptBlockText: '*function MainPayload*'
    SELECTION_5:
        ScriptBlockText: '*::WriteAllBytes*'
    SELECTION_6:
        ScriptBlockText: '*wscript.exe*'
    condition: (SELECTION_1 and SELECTION_2 and SELECTION_3 and SELECTION_4 and SELECTION_5
        and SELECTION_6)
falsepositives:
- Unknown
id: 71c432c4-e4da-4eab-ba49-e60ea9a81bca
level: high
logsource:
    category: ps_script
    definition: bade5735-5ab0-4aa7-a642-a11be0e40872
    product: windows
references:
- https://labs.withsecure.com/publications/fin7-target-veeam-servers
status: test
tags:
- attack.execution
- attack.t1059.001

