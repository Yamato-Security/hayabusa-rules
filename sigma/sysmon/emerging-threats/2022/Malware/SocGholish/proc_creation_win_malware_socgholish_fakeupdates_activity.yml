title: FakeUpdates/SocGholish Activity
id: 5c177a94-baf0-57bc-7664-de520964d60d
related:
    - id: 97805087-93ab-4203-b5cb-287cda6aecaa
      type: derived
status: experimental
description: Detects initial execution of FakeUpdates/SocGholish malware via wscript that later executes commands via cmd or powershell.
references:
    - https://twitter.com/th3_protoCOL/status/1536788652889497600
    - https://twitter.com/1ZRR4H/status/1537501582727778304
author: '@kostastsale'
date: 2022-06-16
modified: 2024-08-23
tags:
    - attack.execution
    - attack.t1059.001
    - detection.emerging-threats
    - sysmon
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 1
        Channel: Microsoft-Windows-Sysmon/Operational
    selection:
        ParentImage|endswith: \wscript.exe
        ParentCommandLine|contains|all:
            - \AppData\Local\Temp
            - .zip
            - update
            - .js
        ParentCommandLine|contains:
            - Chrome
            - Edge
            - Firefox
            - Opera
            - Brave   # Not seen in campaigns
            - Vivaldi   # Not seen in campaigns
        Image|endswith:
            - \cmd.exe
            - \powershell.exe
            - \pwsh.exe
    condition: process_creation and selection
falsepositives:
    - Unlikely
level: high
ruletype: Sigma
