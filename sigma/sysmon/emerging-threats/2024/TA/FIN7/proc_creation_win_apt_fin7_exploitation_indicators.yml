title: Potential APT FIN7 Exploitation Activity
id: e6ccd1de-9a54-1d1e-637a-571e41c27026
related:
    - id: 6676896b-2cce-422d-82af-5a1abe65e241
      type: derived
status: test
description: |
    Detects potential APT FIN7 exploitation activity as reported by Google.
    In order to obtain initial access, FIN7 used compromised Remote Desktop Protocol (RDP) credentials to login to a target server and initiate specific Windows process chains.
references:
    - https://cloud.google.com/blog/topics/threat-intelligence/evolution-of-fin7/
author: Alex Walston (@4ayymm)
date: '2024-07-29'
tags:
    - attack.execution
    - attack.t1059.001
    - attack.t1059.003
    - detection.emerging-threats
    - sysmon
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 1
        Channel: Microsoft-Windows-Sysmon/Operational
    selection_notepad_plus:
        ParentImage|endswith: \notepad++.exe
        Image|endswith: \cmd.exe
    selection_rdpinit:
        ParentImage|endswith: \rdpinit.exe
        Image|endswith: \notepad++.exe
    condition: process_creation and (1 of selection_*)
falsepositives:
    - Notepad++ can legitimately spawn cmd (Open Containing Folder in CMD)
level: medium
ruletype: Sigma
