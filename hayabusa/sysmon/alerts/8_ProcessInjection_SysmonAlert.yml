author: Zach Mathis
date: 2022/03/05
modified:  2022/03/22

title: Process Injection_Sysmon Alert
details: '%RuleName% | Src Process: %SourceImage% | Tgt Process: %TargetImage% | Src PID: %SourceProcessId% | Src PGUID: %SourceProcessGuid% | Tgt PID: %TargetProcessId% | Tgt PGUID: %TargetProcessGuid%'
description: |
    The CreateRemoteThread (Process Injection) event detects when a process creates a thread in another process. 
    This technique is used by malware to inject code and hide in other processes. 
    The event indicates the source and target process. 
    It gives information on the code that will be run in the new thread: StartAddress, StartModule and StartFunction. 
    Note that StartModule and StartFunction fields are inferred, they might be empty if the starting address is outside loaded modules or known exported functions.

id: 3fe8927b-be96-450e-8040-514229aa6baf
level: high
status: testing
logsource:
    product: windows
    service: sysmon
    definition: Sysmon needs to be installed and configured.
detection:
    selection_basic:
        Channel: Microsoft-Windows-Sysmon/Operational
        EventID:  8
    filter_no_alerts:
        - RuleName: ""
        - RuleName: "-"
    condition: selection_basic and not filter_no_alerts
falsepositives:
tags:
references:
    - https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon
ruletype: Hayabusa

sample-evtx: #No example yet.
    