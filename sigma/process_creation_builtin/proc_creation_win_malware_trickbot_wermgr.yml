
title: Trickbot Malware Activity
ruletype: Sigma
author: Florian Roth
date: 2020/11/26
description: Detects Trickbot malware process tree pattern in which rundll32.exe is
  parent of wermgr.exe
detection:
  SELECTION_1:
    EventID: 4688
  SELECTION_2:
    Channel: Security
  SELECTION_3:
    NewProcessName:
    - '*\wermgr.exe'
  SELECTION_4:
    ParentProcessName:
    - '*\rundll32.exe'
  SELECTION_5:
    ParentCommandLine:
    - '*DllRegisterServer*'
  condition: (SELECTION_1 and SELECTION_2 and SELECTION_3 and SELECTION_4 and SELECTION_5)
falsepositives:
- Unknown
id: 58bf96d9-ff5f-44bd-8dcc-1c4f79bf3a27
level: critical
logsource:
  category: process_creation
  product: windows
modified: 2021/11/27
references:
- https://twitter.com/swisscom_csirt/status/1331634525722521602?s=20
- https://app.any.run/tasks/f74c5157-8508-4ac6-9805-d63fe7b0d399/
status: stable
tags:
- attack.execution
- attack.t1559
