title: Potential Pikabot Discovery Activity - Suspicious Process Created By Rundll32.EXE
id: 698d4431-514f-4c82-af4d-cf573872a9f5
status: experimental
description: 'Detects the execution of rundll32 that leads to system discovery activity,
    such as incl. network, user info and domain groups.

    The malware Pikabot has been seen to use this technique as part of its C2-botnet
    registration with a short collection time frame (less than 1 minute).

    '
references:
    - https://www.virustotal.com/gui/file/72f1a5476a845ea02344c9b7edecfe399f64b52409229edaf856fcb9535e3242
author: Andreas Braathen (mnemonic.io)
date: 2023/10/27
tags:
    - attack.discovery
    - attack.t1016
    - attack.t1049
    - attack.t1087
    - detection.emerging_threats
    - sysmon
logsource:
    product: windows
    category: process_creation
    definition: 'Requirements: By default the process_creation type event might not
        contain the GrandParentImage. Make sure you collect such fields in order to
        use this rule'
detection:
    process_creation:
        EventID: 1
        Channel: Microsoft-Windows-Sysmon/Operational
    selection_grandparent:
        GrandParentImage|endswith: \rundll32.exe
    selection_cmdline:
        CommandLine:
            - ipconfig.exe /all
            - netstat.exe -aon
            - whoami.exe /all
    condition: process_creation and (all of selection_*)
falsepositives:
    - Unlikely
level: high
ruletype: Sigma
