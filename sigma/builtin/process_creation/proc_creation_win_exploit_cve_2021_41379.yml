title: Potential CVE-2021-41379 Exploitation Attempt
ruletype: Sigma
author: Florian Roth (Nextron Systems)
date: 2021/11/22
description: Detects potential exploitation attempts of CVE-2021-41379 (InstallerFileTakeOver),
    a local privilege escalation (LPE) vulnerability where the attacker spawns a "cmd.exe"
    process as a child of Microsoft Edge elevation service "elevation_service" with
    "LOCAL_SYSTEM" rights
detection:
    SELECTION_1:
        EventID: 4688
    SELECTION_2:
        Channel: Security
    SELECTION_3:
        NewProcessName: '*\cmd.exe'
    SELECTION_4:
        OriginalFileName: Cmd.Exe
    SELECTION_5:
        ParentProcessName: '*\elevation_service.exe'
    SELECTION_6:
        IntegrityLevel: System
    condition: ((SELECTION_1 and SELECTION_2) and (SELECTION_3 or SELECTION_4) and
        (SELECTION_5 and SELECTION_6))
falsepositives:
- Unknown
id: af8bbce4-f751-46b4-8d91-82a33a736f61
level: critical
logsource:
    category: process_creation
    product: windows
modified: 2023/02/11
references:
- https://web.archive.org/web/20220421061949/https://github.com/klinix5/InstallerFileTakeOver
- https://www.bleepingcomputer.com/news/microsoft/new-windows-zero-day-with-public-exploit-lets-you-become-an-admin/
- https://www.zerodayinitiative.com/advisories/ZDI-21-1308/
status: test
tags:
- attack.privilege_escalation
- attack.t1068

