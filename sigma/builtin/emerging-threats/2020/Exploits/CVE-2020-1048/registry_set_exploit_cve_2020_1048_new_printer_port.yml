title: CVE-2020-1048 Exploitation Attempt - Suspicious New Printer Ports - Registry
id: 630f16a8-0e53-642e-ff10-1e8fdeb631b8
related:
    - id: 7ec912f2-5175-4868-b811-ec13ad0f8567
      type: derived
status: test
description: |
    Detects changes to the "Ports" registry key with data that includes a Windows path or a file with a suspicious extension.
    This could be an attempt to exploit CVE-2020-1048 - a Windows Print Spooler elevation of privilege vulnerability.
references:
    - https://windows-internals.com/printdemon-cve-2020-1048/
author: EagleEye Team, Florian Roth (Nextron Systems), NVISO
date: 2020-05-13
modified: 2024-03-25
tags:
    - attack.persistence
    - attack.execution
    - attack.defense-evasion
    - attack.t1112
    - cve.2020-1048
    - detection.emerging-threats
logsource:
    product: windows
    category: registry_set
detection:
    registry_set:
        EventID: 4657
        Channel: Security
    selection:
        ObjectName|contains: \Microsoft\Windows NT\CurrentVersion\Ports
        NewValue|contains:
            - .bat
            - .com
            - .dll
            - .exe
            - .ps1
            - .vbe
            - .vbs
            - 'C:'
    condition: registry_set and selection
falsepositives:
    - New printer port install on host
level: high
ruletype: Sigma
