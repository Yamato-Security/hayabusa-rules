title: DarkGate - Drop DarkGate Loader In C:\Temp Directory
id: c7d1bfc9-1cbb-923f-f387-cd746b4b7da5
related:
    - id: df49c691-8026-48dd-94d3-4ba6a79102a8
      type: derived
status: test
description: Detects attackers attempting to save, decrypt and execute the DarkGate Loader in C:\temp folder.
references:
    - https://www.bleepingcomputer.com/news/security/hackers-exploit-windows-smartscreen-flaw-to-drop-darkgate-malware/
    - https://www.trendmicro.com/en_us/research/24/c/cve-2024-21412--darkgate-operators-exploit-microsoft-windows-sma.html
author: Tomasz Dyduch, Josh Nickels
date: 2024-05-31
tags:
    - attack.execution
    - attack.t1059
    - detection.emerging-threats
    - sysmon
logsource:
    category: file_event
    product: windows
detection:
    file_event:
        EventID: 11
        Channel: Microsoft-Windows-Sysmon/Operational
    selection_filename_suffix:
        TargetFilename|contains: :\temp\
        TargetFilename|endswith:
            - .au3
            - \autoit3.exe
    selection_image_suffix:
        Image|contains: :\temp\
        Image|endswith:
            - .au3
            - \autoit3.exe
    condition: file_event and (1 of selection_*)
falsepositives:
    - Unlikely legitimate usage of AutoIT in temp folders.
level: medium
ruletype: Sigma
