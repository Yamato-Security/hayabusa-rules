title: Potential Pikabot C2 Activity - Suspicious Process Created By Rundll32.EXE
id: cae6cee6-0244-44d2-84ed-e65f548eb7dc
status: experimental
description: 'Detects the execution of rundll32 that leads to an external network
    connection.

    The malware Pikabot has been seen to use this technique to initiate C2-communication
    through hard-coded Windows binaries.

    '
references:
    - https://www.virustotal.com/gui/file/d72af640b71b8e3eca3eba660dd7c7f029ff8852bcacaa379e7b6c57cf4d9b44
author: Andreas Braathen (mnemonic.io)
date: 2023/10/27
tags:
    - attack.command_and_control
    - attack.t1573
    - detection.emerging_threats
    - sysmon
logsource:
    product: windows
    category: network_connection
    definition: 'Requirements: By default the network_connection type event might
        not contain the ParentImage. Make sure you collect such fields in order to
        use this rule'
detection:
    network_connection:
        EventID: 3
        Channel: Microsoft-Windows-Sysmon/Operational
    selection_parent:
        ParentImage|endswith: \rundll32.exe
    selection_child:
        Image|endswith:
            - \searchprotocolhost.exe
            - \sndvol.exe
            - \wermgr.exe
            - \wwahost.exe
    selection_connection:
        Protocol: tcp
        Initiated: 'true'
    condition: network_connection and (all of selection_*)
falsepositives:
    - Unlikely
level: high
ruletype: Sigma
