title: Potential MOVEit Transfer CVE-2023-34362 Exploitation
id: c3b2a774-3152-4989-83c1-7afc48fd1599
status: experimental
description: Detects file indicators of potential exploitation of MOVEit CVE-2023-34362.
references:
    - https://www.bleepingcomputer.com/news/security/new-moveit-transfer-zero-day-mass-exploited-in-data-theft-attacks/
    - https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023
    - https://www.rapid7.com/blog/post/2023/06/01/rapid7-observed-exploitation-of-critical-moveit-transfer-vulnerability/
    - https://www.reddit.com/r/sysadmin/comments/13wxuej/comment/jmhdg55/
author: Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)
date: 2023/06/01
modified: 2023/06/03
tags:
    - attack.initial_access
    - attack.t1190
    - cve.2023.34362
    - detection.emerging_threats
    - sysmon
logsource:
    category: file_event
    product: windows
detection:
    file_event:
        EventID: 11
        Channel: Microsoft-Windows-Sysmon/Operational
    selection_generic:
        TargetFilename|contains:
            - \MOVEit Transfer\wwwroot\
            - \MOVEitTransfer\wwwroot\
        TargetFilename|endswith:
            - .7z
            - .bat
            - .dll
            - .exe
            - .ps1
            - .rar
            - .vbe
            - .vbs
            - .zip
    selection_known_ioc:
        TargetFilename|endswith:
            - \MOVEit Transfer\wwwroot\_human2.aspx.lnk
            - \MOVEit Transfer\wwwroot\_human2.aspx
            - \MOVEit Transfer\wwwroot\human2.aspx.lnk
            - \MOVEit Transfer\wwwroot\human2.aspx
            - \MOVEitTransfer\wwwroot\_human2.aspx.lnk
            - \MOVEitTransfer\wwwroot\_human2.aspx
            - \MOVEitTransfer\wwwroot\human2.aspx.lnk
            - \MOVEitTransfer\wwwroot\human2.aspx
    # Uncomment selection if you wanna threat hunt for additional artifacts
    # selection_cmdline:
    #    TargetFilename|contains: ':\Windows\TEMP\'
    #    TargetFilename|endswith: '.cmdline'
    selection_compiled_asp:
        CreationUtcTime|startswith:
            - '2023-03- '
            - '2023-04- '
            - '2023-05- '
            - '2023-06- '
        TargetFilename|contains|all:
            - \Windows\Microsoft.net\Framework64\v
            - \Temporary ASP.NET Files\
            - App_Web_
        TargetFilename|endswith: .dll
    condition: file_event and (1 of selection_*)
falsepositives:
    - To avoid FP, this rule should only be applied on MOVEit servers.
level: high
ruletype: Sigma
