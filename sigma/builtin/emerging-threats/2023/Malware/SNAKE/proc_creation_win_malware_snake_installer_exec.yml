title: Potential SNAKE Malware Installation Binary Indicator
id: 4b4e4330-74b5-c191-3016-18ec0b0e8c15
related:
    - id: d91ff53f-fd0c-419d-a6b8-ae038d5c3733
      type: derived
status: test
description: Detects a specific binary name seen used by SNAKE malware during its installation as described by CISA in their report
references:
    - https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023-05-04
tags:
    - attack.execution
    - detection.emerging-threats
logsource:
    category: process_creation
    product: windows
detection:
    process_creation:
        EventID: 4688
        Channel: Security
    selection:
        NewProcessName|endswith:
            - \jpsetup.exe
            - \jpinst.exe
    filter_main_cli_name:
        CommandLine:
            - jpinst.exe
            - jpinst
            - jpsetup.exe
            - jpsetup
    filter_main_cli_empty:
        CommandLine: ''
    filter_main_cli_null:
        CommandLine: null
    condition: process_creation and (selection and not 1 of filter_main_*)
falsepositives:
    - Unlikely
level: high
ruletype: Sigma
